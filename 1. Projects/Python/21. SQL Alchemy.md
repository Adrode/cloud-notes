#sqlalchemy
## Czym jest SQLAlchemy?
#sqlalchemy 
- **SQLAlchemy** - składa się z toolkita SQL do Pythona (sqlalchemy core) oraz z ORM (Object Relational Mapper).
	- ORM czyli obsługa SQL z poziomu Pythona, za pomocą obiektów, gdzie klasy reprezentują tablice
	- przykładowy kod
```python
from sqlalchemy import create_engine, Integer, String, Float, Column, ForeignKey
from sqlalchemy.orm import declarative_base, sessionmaker, relationship

engine = create_engine('postgresql+psycopg2://postgres:postgres@localhost:5432/satutorialdatabase', echo=True)

Base = declarative_base()

class Person(Base):
	__tablename__ = 'people'
	id = Column(Integer, primary_key=True)
	name = Column(String, nullable=False)
	age = Column(Integer)
	
	things = relationship('Thing', back_populates='person')
	
class Thing(Base):
	__tablename__ = 'things'
	id = Column(Integer, primary_key=True)
	description = Column(String, nullable=False)
	value = Column(Float)
	owner = Column(Integer, ForeignKey('people.id'))
```

## Jak zainstalować SQLAlchemy?
#sqlalchemy 
- Instalacja za pomocą pip:
	- `pip install sqlalchemy`

## Jakie są podstawy SQLAlchemy Core?
#sqlalchemy #core
```python
from sqlalchemy import create_engine, text

engine = create_engine('sqlite:///mydatabase.db', echo=True)
...
```
- `engine` - tworzy centralny obiekt SQLAlchemy (przez `create-engine`), czyli:
	- trzyma informacje jak połączyć się z bazą
	- zarządza połączeniem z bazą danych
	- wysyła SQL do bazy
- `sqlite:///mydatabase.db` - URL bazy danych:
	- `sqlite` - typ bazy danych
	- `:///` - lokalny plik
	- `mydatabase.db` - plik bazy danych
- `echo=True` - wyświetla generowane zapytania SQL do konsoli
	- bardzo przydatne do debugowania i nauki
```python
...
conn = engine.connect()

conn.execute(text("CREATE TABLE IF NOT EXISTS people (name str, age int)"))

conn.commit()
```
- `engine.connect()` - nawiązanie połączenia między Pythonem a bazą danych
- `conn.execute(text(SQL query))` - wykonanie zapytania SQL
	- jednocześnie ten .execute() otwiera transakcję
- `conn.commit()` - zamknięcie transakcji, zapisanie zmian
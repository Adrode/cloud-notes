#systemd 
## Czym jest systemd?
#systemd
- **systemd** - to menedżer usług. Jest to taki nadrzędny system, który obsługuje wszystkie daemony i procesy działające w tle. Uruchamia je, monitoruje ich działanie i w razie problemów uruchamia je ponownie. **Jest trochę jak jądro systemu, z tym że w warstwie użytkownika.**
	- Odpowiada za: 
		- **uruchamia system** - włącza wszystkie niezbędne procesy i daemony w trakcie bootowania
		- **zarządza usługami** - czyli procesami działającymi w tle
		- **zarządza zależnościami między usługami** - np. najpierw uruchamia bazę danych, a potem program który z niej korzysta
		- **obsługa logów, urządzeń, sesji użytkowników, itp.**

## Czym są procesy specjalne?
#daemon #service
- **Daemon** - proces działający w tle i wykonujący jakieś zadania ciągle lub na żądanie
	- działa samodzielnie
	- nie steruje się nim bezpośrednio, lecz za pomocą innych programów
	- np. **sshd** (połączenie ssh), **cron** (harmonogram), **syslogd** (monitorowanie, logi systemowe)
- **Service (usługa)** - sposób, w jaki mogę kontrolować proces działający w tle, np. **daemona**
	- pozwala na łatwe uruchamianie, zatrzymywanie, wznawianie i monitorowanie daemonów
	- np. **systemctl start sshd.service** - uruchomi tego daemona jako usługę

## Czym są jednostki?
#units
- Wszystko czym zarządza systemd, jest nazywane **unit (jednostką)**.
- Typy jednostek:
	- **service** - usługi
	- **socket** - gniazda sieciowe
	- **target** - grupy jednostek
	- **mount** - punkt montowania
	- **device** - urządzenia
		- **systemctl operuje na tych jednostkach**

## Czym są pliki jednostek?
#unitfiles
- Działanie serwisów jest opisane w plikach **.service**
	- Opisują jak i kiedy uruchomić daemon / proces, jakie ma mieć zależności, jak się zachowywać po błędach, itd.
- Można je modyfikować lub tworzyć własne
- Standardowo znajdują się w:
	- **/lib/systemd/system/** - pliki .service zainstalowane z pakietami systemowymi (np. cron, ssh)
	- **/etc/systemd/system/** - tutaj modyfikuje się lub dodaje własne pliki .service
		- pliki stąd będą używane zamiast oryginałów z /lib
			- jest tak, ponieważ przy aktualizacji systemu zmodyfikowane pliki zostałyby nadpisane przez aktualizację
## Jak obsługiwać serwisy?
#systemctl #service
- **service** - program do zarządzania serwisami background'owymi, starsze, proste opcje do zarządzania, **do starego *init***
	- **service *nazwa_serwisu* status / start / stop / restart** - wspomniane wcześniej uruchamianie, zatrzymywanie, wznawianie i monitorowanie daemonów
- **systemctl** - program do zarządzania serwisami background'owymi, bardziej rozbudowane, **do zarządzania systemd**
	- **systemctl *enable / restart / start / status / stop / reload / disable / \[...]* *nazwa_serwisu***
		- ***reload*** - "miękki" restart
		- ***disabled*** - dezaktywacja automatycznego uruchamiania serwisu przy starcie systemu
			- ***enabled*** - uaktywnia serwis
		- ***start / stop*** - wznawia / zatrzymuje działanie serwisu
		- **is-enabled** - czy aktywna do włączenia przy starcie systemu
		- **daemon-reload** - przeładowanie konfiguracji jednostek (np. po zmianach w plikach .service)
- **UWAGA!** Jeśli wywołam **service cron status** oraz **systemctl status cron** to dostanę **ten sam wynik!**
	- service pozostał dla kompatybilności wstecznej, więc wywoływanie go w nowych systemach (np. Ubuntu 20+) **tak naprawdę powoduje odniesienie się do systemctl i wywołanie programu systemctl**

## Jak sprawdzić logi systemd?
#journalctl
- **journalctl** - komenda, wyświetla logi zebrane przez systemd
	- **journal -u *nazwa*.service** - logi dla danej usługi